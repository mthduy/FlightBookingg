<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lập lịch chuyến bay - TravelSky</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/employeestyles.css">
</head>
<body>

<header class="navbar">
    <a href="/" class="logo">TravelSky</a>
    <nav class="menu">
        <a href="/logout" class="btn-primary">Đăng xuất</a>

    </nav>
</header>

<main class="main-container">
    <div class="_sidebar">
        <ul class="menu-list">
            <li><a href="/employee_sell_ticket" class="menu-item">Bán vé</a></li>
            <li><a href="/employee_flight_search" class="menu-item">Tra cứu chuyến bay</a></li>
            <li><a href="/employee_schedule_flight" class="menu-item">Lập lịch chuyến bay</a></li>
        </ul>
    </div>

    <div class="schedule_flight_content">
        <h2>Lập lịch chuyến bay</h2>
       <form method="POST">
    <label for="flight_id">Mã chuyến bay:</label>
    <input type="text" id="flight_id" name="flight_id" required>

    <label for="departure_airport">Sân bay đi:</label>
    <select id="departure_airport" name="departure_airport" required>
        <option value="" disabled selected>Chọn sân bay đi</option>
        {% for airport in airports %}
           <option value="{{ airport.id }}">{{ airport.tenSanBay }} ({{ airport.maSanBay }})</option>
        {% endfor %}
    </select>

    <label for="arrival_airport">Sân bay đến:</label>
    <select id="arrival_airport" name="arrival_airport" required>
        <option value="" disabled selected>Chọn sân bay đến</option>
        {% for airport in airports %}
            <option value="{{ airport.id }}">{{ airport.tenSanBay }} ({{ airport.maSanBay }})</option>
        {% endfor %}
    </select>

 <label>Sân bay trung gian:</label>
<div id="intermediate_airports_container">
    <!-- Initially, no intermediate airports will be shown -->
</div>

<!-- Button to add more intermediate airports -->
<button type="button" onclick="addIntermediateAirport()">Thêm sân bay trung gian</button>




    <label for="flight_time">Ngày – giờ:</label>
    <input type="datetime-local" id="flight_time" name="flight_time" required>

    <label for="flight_duration">Thời gian bay (hh:mm):</label>
    <input type="text" id="flight_duration" name="flight_duration" required>

    <!-- Tự động hiển thị các loại ghế và giá tiền -->
   {% for ticket_class in ticket_classes %}
        <label for="class_{{ ticket_class.index }}_seats">Số lượng ghế {{ ticket_class.class_name }} TEST:id="class_{{ ticket_class.index }}_seats"
               name="class_{{ ticket_class.index }}_seats":</label>
        <input type="number" id="class_{{ ticket_class.index }}_seats"
               name="class_{{ ticket_class.index }}_seats"
               required>

        <label for="class_{{ ticket_class.index }}_price">Giá tiền cho {{ ticket_class.class_name }}TEST:id="class_{{ ticket_class.index }}_seats":</label>
        <input type="number" id="class_{{ ticket_class.index }}_price"
               name="class_{{ ticket_class.index }}_price"
               value="{{ ticket_class.price }}"
               required readonly>
    {% endfor %}


    <button type="submit" class="btn-primary">Lập lịch chuyến bay</button>
</form>

        {% if message %}
            <p>{{ message }}</p>
        {% endif %}
    </div>
</main>

<footer>
    <p>© 2024 TravelSky - Đặt vé máy bay dễ dàng và nhanh chóng</p>
</footer>
  <script>
    let airportCounter = 0;  // Start counter for intermediate airports
    const maxIntermediateAirports = {{ max_intermediate_airports }};  // Set the maximum number of intermediate airports

    // Function to add a new intermediate airport row
    function addIntermediateAirport() {
        if (airportCounter < maxIntermediateAirports) {
            const container = document.getElementById('intermediate_airports_container');
            const newRow = document.createElement('div');
            newRow.classList.add('intermediate_airport_row');
            newRow.id = 'row_' + airportCounter;

            newRow.innerHTML = `
                <select name="intermediate_airports[${airportCounter}][id]" required>
                    <option value="" disabled selected>Chọn sân bay trung gian</option>
                    {% for airport in airports %}
                        <option value="{{ airport.id }}">{{ airport.tenSanBay }} ({{ airport.maSanBay }})</option>
                    {% endfor %}
                </select>
                <input type="text" name="intermediate_airports[${airportCounter}][stop_time]" placeholder="Thời gian dừng (hh:mm)" required>
                <button type="button" class="remove-btn" onclick="removeIntermediateAirport(${airportCounter})">Xóa</button>
            `;

            container.appendChild(newRow);
            airportCounter++;  // Increment the counter for the next row
        } else {
            alert('Bạn đã vượt quá số lượng sân bay trung gian tối đa!');
        }
    }

    // Function to remove an intermediate airport row
    function removeIntermediateAirport(rowId) {
        const row = document.getElementById('row_' + rowId);
        if (row) {
            row.remove();
            airportCounter--;  // Decrease the counter when a row is removed
        }
    }
</script>
</body>
</html>
